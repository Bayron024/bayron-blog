<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸ªäººåšå®¢ - åŒ¹é…å°æ¸¸æˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        body.game-mode {
            background: white;
            padding: 0;
        }

        .container {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(12px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 40px;
            max-width: 600px;
            width: 100%;
            text-align: center;
        }

        body.game-mode .container {
            background: white;
            backdrop-filter: none;
            border-radius: 0;
            border: none;
            padding: 0;
            max-width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            margin: 0 auto 20px;
            border: 3px solid rgba(255, 255, 255, 0.5);
            background: url('7.jpg') center/cover;
        }

        .signature {
            font-size: 24px;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 30px;
            font-weight: 300;
        }

        .links {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .link-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px 25px;
            border-radius: 12px;
            cursor: pointer;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .link-item:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .link-title {
            font-size: 18px;
            color: white;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .link-desc {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
            font-style: italic;
        }

        .icon {
            width: 20px;
            height: 20px;
            display: inline-block;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        /* æ¸¸æˆç›¸å…³æ ·å¼ */
        .game-container {
            display: none;
            flex-direction: column;
            height: 100%;
        }

        .game-header {
            text-align: center;
            padding: 20px 0;
            border-bottom: 1px solid #eee;
        }

        .game-title {
            font-size: 28px;
            color: #333;
            margin-bottom: 10px;
        }

        .game-subtitle {
            font-size: 20px;
            color: #666;
        }

        .game-content {
            display: flex;
            flex-direction: column;
            flex: 1;
            padding: 20px;
        }

        .text-options-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }

        .image-options-container {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
            flex: 1;
            align-items: center;
        }

        .text-option {
            background: #f8f9fa;
            padding: 15px 25px;
            border-radius: 8px;
            cursor: pointer;
            border: 2px solid transparent;
            font-size: 16px;
            color: #333;
            min-width: 100px;
            text-align: center;
        }

        .text-option.selected {
            border-color: #ff6b6b;
            background: #fff5f5;
        }

        .image-option {
            width: 200px;
            height: 200px;
            background: #f8f9fa;
            border-radius: 8px;
            cursor: pointer;
            border: 2px solid transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
        }

        .image-option.selected {
            border-color: #ff6b6b;
            background-color: #fff5f5;
        }

        .game-footer {
            padding: 20px;
            border-top: 1px solid #eee;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .confirm-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            display: none;
        }

        .confirm-btn.error {
            background: #f44336;
        }

        .message {
            padding: 10px 20px;
            border-radius: 6px;
            font-size: 14px;
            text-align: center;
            display: none;
            max-width: 500px;
        }

        .error-message {
            background: #ffebee;
            color: #c62828;
            border: 1px solid #ffcdd2;
        }

        .success-message {
            background: #e8f5e8;
            color: #2e7d32;
            border: 1px solid #c8e6c9;
        }

        .special-message {
            background: #fff3e0;
            color: #ef6c00;
            border: 1px solid #ffcc80;
        }

        .back-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            background: white;
            color: #333;
            border: 1px solid #ddd;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            display: none;
        }

        @media (max-width: 768px) {
            .text-options-container, .image-options-container {
                flex-direction: column;
                align-items: center;
            }
            
            .image-option {
                width: 150px;
                height: 150px;
            }
        }
    </style>
</head>
<body>
    <button class="back-btn" onclick="backToHome()">â† è¿”å›ä¸»é¡µ</button>
    
    <div class="container">
        <!-- ä¸»é¡µå†…å®¹ -->
        <div class="home-content">
            <div class="avatar"></div>
            <h1 class="signature">Having a nice day</h1>
            
            <div class="links">
                <a href="https://space.bilibili.com/3546699649779848" target="_blank">
                    <div class="link-item">
                        <div class="link-title">
                            <span class="icon">ğŸ“º</span>
                            Bç«™ç©ºé—´
                        </div>
                        <div class="link-desc">æ¬¢è¿æ¥æ‰¾æœ¬äººç©</div>
                    </div>
                </a>

                <a href="https://github.com/Bayron024" target="_blank">
                    <div class="link-item">
                        <div class="link-title">
                            <span class="icon">ğŸ’»</span>
                            GitHub
                        </div>
                        <div class="link-desc">è®¡ç®—æœºå°ç™½ï¼Œä¸è¦æ‹·æ‰“æˆ‘QAQ</div>
                    </div>
                </a>

                <div class="link-item" onclick="alert('QQå·ï¼š1328574706')">
                    <div class="link-title">
                        <span class="icon">ğŸ’¬</span>
                        QQ
                    </div>
                    <div class="link-desc">æ¬¢è¿æ¥æ‰¾æœ¬äººèŠå¤©</div>
                </div>

                <a href="https://steamcommunity.com/profiles/76561199733952633/" target="_blank">
                    <div class="link-item">
                        <div class="link-title">
                            <span class="icon">ğŸ®</span>
                            Steam
                        </div>
                        <div class="link-desc">ä»¥æ’’ç•ŒèŒæ–°ï¼Œæ¬¢è¿è”æœº</div>
                    </div>
                </a>

                <!-- æ¸¸æˆæŒ‰é’® -->
                <div class="link-item" onclick="startGame()">
                    <div class="link-title">
                        <span class="icon">ğŸ®</span>
                        å¼€å§‹å…»æˆå°æ¸¸æˆ
                    </div>
                    <div class="link-desc">è­¦å‘Šï¼šå†…å«éƒ¨åˆ†çŒå¥‡å†…å®¹</div>
                </div>
            </div>
        </div>

        <!-- æ¸¸æˆå†…å®¹ -->
        <div class="game-container">
            <div class="game-header">
                <h2 class="game-title">å…»æˆç³»å°æ¸¸æˆ</h2>
                <h3 class="game-subtitle" id="level-title">ç¬¬1å…³ï¼šæ•‘å“ªä¸ªï¼Ÿ</h3>
            </div>
            
            <div class="game-content">
                <!-- æ–‡å­—é€‰é¡¹åœ¨ä¸Š -->
                <div class="text-options-container" id="text-options">
                    <!-- æ–‡å­—é€‰é¡¹å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
                </div>
                
                <!-- å›¾ç‰‡é€‰é¡¹åœ¨ä¸‹ -->
                <div class="image-options-container" id="image-options">
                    <!-- å›¾ç‰‡é€‰é¡¹å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
            
            <div class="game-footer">
                <div class="message error-message" id="error-message"></div>
                <div class="message success-message" id="success-message"></div>
                <div class="message special-message" id="special-message"></div>
                
                <button class="confirm-btn" id="confirm-btn">ç¡®è®¤</button>
            </div>
        </div>
    </div>

    <script>
        // æ¸¸æˆæ•°æ® - æŒ‰ç…§æ–°çš„å‘½åè§„åˆ™
        const gameData = [
            // ç¬¬1å…³ - ç‰¹æ®Šå…³å¡ï¼Œæœ‰ä¸¤ä¸ªå›¾ç‰‡å’Œä¸‰ä¸ªæ–‡å­—é€‰é¡¹
            {
                title: "ç¬¬1å…³ï¼šæ•‘å“ªä¸ªï¼Ÿ",
                type: "special",
                images: [
                    "images/content/level1/nyn_1_a.jpg",  // å·¦è¾¹ï¼šå¨œå¨œ
                    "images/content/level1/rain_1_a.jpg"  // å³è¾¹ï¼šå°é›¨
                ],
                texts: ["æ•‘å¨œå¨œ", "æ•‘å°é›¨", "éƒ½æ•‘"],
                correctAnswer: 2,
                successMessage: "ä½ æ•‘ä¸‹äº†å¥¹ä»¬ï¼è¿™æ˜¯æ³¨å®šä¸å‡¡çš„ä¸€å¯¹å­©å­",
                errorMessages: [
                    "ä¸ºä»€ä¹ˆè¦æ”¾å¼ƒå°é›¨ï¼ï¼Ÿï¼ï¼Ÿ",
                    "å¨œè‰ºå¨œåšé”™ä»€ä¹ˆäº†ï¼ï¼Ÿï¼ï¼Ÿ",
                    "è¿™ä¸ªé€‰é¡¹æ˜¯é”™è¯¯çš„ï¼Œè¯·é‡æ–°é€‰æ‹©"
                ],
                changeImages: false
            },
            // ç¬¬2å…³ - æ”¹ä¸ºç‰¹æ®Šå…³å¡ï¼ŒäºŒé€‰ä¸€
            {
                title: "ç¬¬2å…³ï¼šå–‚å…»é£Ÿç‰©",
                type: "special",
                images: [
                    "images/content/level2/nyn_2_a.jpg",  // å·¦è¾¹ï¼šå¨œå¨œ
                    "images/content/level2/rain_2_a.jpg"  // å³è¾¹ï¼šå°é›¨
                ],
                texts: ["é¸¡è›‹ç‰›å¥¶", "ç‚¸é¸¡æ±‰å ¡"],
                correctAnswer: 0,
                successMessage: "å¨œå¨œå’Œå°é›¨æ„Ÿåˆ°å¾ˆå¥åº·ï¼å¥¹ä»¬èŒå£®æˆé•¿äº†",
                errorMessages: [
                    "",
                    "ä½ ç»™å¥¹ä»¬åƒäº†ç‚¸é¸¡æ±‰å ¡ï¼Œå¥åº·å€¼-100ï¼Œä½ è¾“äº†"
                ],
                changeImages: false
            },
            // ç¬¬3å…³ - åªæœ‰è¿™ä¸€å…³æ­£ç¡®åä¼šå˜åŒ–å›¾ç‰‡
            {
                title: "ç¬¬3å…³ï¼šå„æœ‰æ‰€é•¿",
                type: "normal",
                images: [
                    "images/content/level3/nyn_3_a.jpg",  // å·¦è¾¹ï¼šå¨œå¨œ
                    "images/content/level3/rain_3_a.jpg"  // å³è¾¹ï¼šå°é›¨
                ],
                successImages: [
                    "images/content/level3/nyn_3_b.jpg",  // æ­£ç¡®åå·¦è¾¹å˜åŒ–
                    "images/content/level3/rain_3_b.jpg"  // æ­£ç¡®åå³è¾¹å˜åŒ–
                ],
                texts: ["æ­¦åŠŸ", "èˆè¹ˆ"],
                correctPairs: { 0: 1, 1: 0 },
                successMessage: "ä¸¤äººåœ¨å„è‡ªæ–¹é¢éƒ½å¤©èµ‹å¼‚ç¦€ï¼Œä½ åšå‡ºäº†æ­£ç¡®çš„é€‰æ‹©",
                errorMessages: [
                    "å¨œè‰ºå¨œåœ¨ç»ƒæ­¦æ—¶æ‘”å€’è¿›åŒ»é™¢äº†ï¼Œè€Œå°é›¨å‡ºååå› ä¸ºå–æœ¨è–¯ç²‰å¡Œæˆ¿äº†ï¼Œå¤©ä¸‹å†æ— å¥³ä¾ ",
                    "y"
                ],
                changeImages: true
            },
            // ç¬¬4å…³ - ä¸ä¼šç«‹å³è¾“æ‰çš„å…³å¡
            {
                title: "ç¬¬4å…³ï¼šç©¿è¡£æ‰“æ‰®",
                type: "normal",
                images: [
                    "images/content/level4/nyn_4_a.jpg",  // å·¦è¾¹ï¼šå¨œå¨œ
                    "images/content/level4/rain_4_a.jpg"  // å³è¾¹ï¼šå°é›¨
                ],
                texts: ["å¸…æ°”", "åä¸½"],
                correctPairs: { 0: 1, 1: 0 },
                successMessage: "ç»è¿‡ä½ çš„ä¸€ç•ªæ‰“æ‰®ï¼Œä¸¤äººçš„æ°”è´¨æ›´åŠ çªå‡ºäº†ï¼",
                errorMessages: [
                    "çœ‹æ¥ä½ çš„å®¡ç¾æ¯”è¾ƒç‰¹åˆ«ã€‚ä¸¤äººçš„é­…åŠ›å‡å°‘35%",
                    "å†³å®š2åº”è¯¥åŒ¹é…å³è¾¹çš„å›¾ç‰‡"
                ],
                changeImages: false,
                noFail: true // æ ‡è®°è¿™ä¸€å…³ä¸ä¼šå¯¼è‡´æ¸¸æˆç»“æŸ
            },
            // ç¬¬5å…³ - æœ€ç»ˆå…³å¡ï¼Œä¼šæ£€æŸ¥ç¬¬4å…³çš„ç»“æœ
            {
                title: "ç¬¬5å…³ï¼šå»å¾€ä½•æ–¹",
                type: "normal",
                images: [
                    "images/content/level5/nyn_5_a.jpg",  // å·¦è¾¹ï¼šå¨œå¨œ
                    "images/content/level5/rain_5_a.jpg"  // å³è¾¹ï¼šå°é›¨
                ],
                texts: ["é€‰ç§€", "é—¯è¡æ±Ÿæ¹–"],
                correctPairs: { 0: 0, 1: 1 },
                successMessage: "å®Œç¾ç»“å±€ğŸ‰ ä½ æˆåŠŸå…»æˆäº†ï¼šğŸŠ çš‡åå’Œæ­¦æ—è‡³å°Šï¼",
                specialFailMessage: "å¨œå¨œç”±äºé­…åŠ›ä¸è¶³ï¼Œé€‰ç§€å¤±è´¥ï¼›é›¨å§ä¹Ÿåœ¨é—¯è¡æ±Ÿæ¹–æ—¶ä¸çŸ¥æ‰€è¸ª",
                normalFailMessage: "é›¨å§è™½ç„¶å¸¦æ´¾ï¼Œä½†è¿˜æ˜¯è¾“ç»™äº†ç»éªŒæ›´åŠ ä¸°å¯Œçš„ä¹”ç¢§èã€‚è‡³äºå¨œè‰ºå¨œâ€”â€”ä½ éš¾é“çœŸå‡†å¤‡è®©å¥¹ç‹¬è‡ªé—¯è¡ï¼Ÿ",
                errorMessages: [
                    "é›¨å§è™½ç„¶å¸¦æ´¾ï¼Œä½†è¿˜æ˜¯è¾“ç»™äº†ç»éªŒæ›´åŠ ä¸°å¯Œçš„ä¹”ç¢§èã€‚è‡³äºå¨œè‰ºå¨œâ€”â€”ä½ éš¾é“çœŸå‡†å¤‡è®©å¥¹ç‹¬è‡ªé—¯è¡ï¼Ÿ",
                    "ç»“å±€Båº”è¯¥åŒ¹é…å³è¾¹çš„å›¾ç‰‡"
                ],
                changeImages: false
            }
        ];

        // æ¸¸æˆçŠ¶æ€
        let currentLevel = 0;
        let selectedTexts = [];
        let selectedImages = [];
        let gameStarted = false;
        let isResultShown = false;
        let level4Failed = false; // è®°å½•ç¬¬4å…³æ˜¯å¦å¤±è´¥

        // DOMå…ƒç´ 
        const homeContent = document.querySelector('.home-content');
        const gameContainer = document.querySelector('.game-container');
        const levelTitle = document.getElementById('level-title');
        const textOptionsContainer = document.getElementById('text-options');
        const imageOptionsContainer = document.getElementById('image-options');
        const confirmBtn = document.getElementById('confirm-btn');
        const errorMessage = document.getElementById('error-message');
        const successMessage = document.getElementById('success-message');
        const specialMessage = document.getElementById('special-message');
        const backBtn = document.querySelector('.back-btn');

        // å¼€å§‹æ¸¸æˆ
        function startGame() {
            document.body.classList.add('game-mode');
            homeContent.style.display = 'none';
            gameContainer.style.display = 'flex';
            backBtn.style.display = 'block';
            gameStarted = true;
            currentLevel = 0;
            level4Failed = false; // é‡ç½®ç¬¬4å…³çŠ¶æ€
            loadLevel(currentLevel);
        }

        // è¿”å›ä¸»é¡µ
        function backToHome() {
            document.body.classList.remove('game-mode');
            homeContent.style.display = 'block';
            gameContainer.style.display = 'none';
            backBtn.style.display = 'none';
            gameStarted = false;
        }

        // åŠ è½½å…³å¡
        function loadLevel(levelIndex) {
            const level = gameData[levelIndex];
            levelTitle.textContent = level.title;
            
            // é‡ç½®é€‰æ‹©
            selectedTexts = [];
            selectedImages = [];
            isResultShown = false;
            
            // æ¸…ç©ºé€‰é¡¹å®¹å™¨
            textOptionsContainer.innerHTML = '';
            imageOptionsContainer.innerHTML = '';
            
            // éšè—æ‰€æœ‰æ¶ˆæ¯
            errorMessage.style.display = 'none';
            successMessage.style.display = 'none';
            specialMessage.style.display = 'none';
            
            // ç‰¹æ®Šå…³å¡å¤„ç†
            if (level.type === "special") {
                // ç‰¹æ®Šå…³å¡ï¼šæ˜¾ç¤ºä¸¤ä¸ªå›¾ç‰‡å’Œä¸‰ä¸ªæ–‡å­—é€‰é¡¹
                level.images.forEach((image, index) => {
                    const imageOption = document.createElement('div');
                    imageOption.className = 'image-option';
                    imageOption.style.backgroundImage = `url(${image})`;
                    imageOption.dataset.index = index;
                    imageOption.onclick = () => selectImage(index);
                    imageOptionsContainer.appendChild(imageOption);
                });
                
                level.texts.forEach((text, index) => {
                    const textOption = document.createElement('div');
                    textOption.className = 'text-option';
                    textOption.textContent = text;
                    textOption.dataset.index = index;
                    textOption.onclick = () => selectText(index);
                    textOptionsContainer.appendChild(textOption);
                });
                
                // ç‰¹æ®Šå…³å¡åªéœ€è¦é€‰æ‹©ä¸€ä¸ªé€‰é¡¹
                confirmBtn.textContent = "ç¡®è®¤é€‰æ‹©";
                confirmBtn.style.display = 'none';
                confirmBtn.onclick = checkSpecialAnswer;
            } else {
                // æ­£å¸¸å…³å¡ï¼šæ˜¾ç¤ºä¸¤ä¸ªå›¾ç‰‡å’Œä¸¤ä¸ªæ–‡å­—
                level.images.forEach((image, index) => {
                    const imageOption = document.createElement('div');
                    imageOption.className = 'image-option';
                    imageOption.style.backgroundImage = `url(${image})`;
                    imageOption.dataset.index = index;
                    imageOption.onclick = () => selectImage(index);
                    imageOptionsContainer.appendChild(imageOption);
                });
                
                level.texts.forEach((text, index) => {
                    const textOption = document.createElement('div');
                    textOption.className = 'text-option';
                    textOption.textContent = text;
                    textOption.dataset.index = index;
                    textOption.onclick = () => selectText(index);
                    textOptionsContainer.appendChild(textOption);
                });
                
                confirmBtn.textContent = "ç¡®è®¤åŒ¹é…";
                confirmBtn.style.display = 'none';
                confirmBtn.onclick = checkNormalAnswer;
            }
            
            // é‡ç½®ç¡®è®¤æŒ‰é’®æ ·å¼
            confirmBtn.classList.remove('error');
        }

        // é€‰æ‹©æ–‡å­—
        function selectText(index) {
            if (isResultShown) return;
            
            const level = gameData[currentLevel];
            
            if (level.type === "special") {
                // ç‰¹æ®Šå…³å¡ï¼šé€‰æ‹©ä¸€ä¸ªæ–‡å­—é€‰é¡¹
                selectedTexts = [index];
                
                // æ›´æ–°UI
                document.querySelectorAll('.text-option').forEach(option => {
                    option.classList.remove('selected');
                });
                document.querySelector(`.text-option[data-index="${index}"]`).classList.add('selected');
                
                // æ˜¾ç¤ºç¡®è®¤æŒ‰é’®
                confirmBtn.style.display = 'block';
            } else {
                // æ­£å¸¸å…³å¡ï¼šé€‰æ‹©æ–‡å­—ä¸å›¾ç‰‡åŒ¹é…
                if (selectedTexts.includes(index)) {
                    selectedTexts = selectedTexts.filter(i => i !== index);
                    document.querySelector(`.text-option[data-index="${index}"]`).classList.remove('selected');
                } else if (selectedTexts.length < 2) {
                    selectedTexts.push(index);
                    document.querySelector(`.text-option[data-index="${index}"]`).classList.add('selected');
                }
                
                checkSelectionComplete();
            }
        }

        // é€‰æ‹©å›¾ç‰‡
        function selectImage(index) {
            if (isResultShown) return;
            
            const level = gameData[currentLevel];
            
            if (level.type === "special") {
                return;
            } else {
                if (selectedImages.includes(index)) {
                    selectedImages = selectedImages.filter(i => i !== index);
                    document.querySelector(`.image-option[data-index="${index}"]`).classList.remove('selected');
                } else if (selectedImages.length < 2) {
                    selectedImages.push(index);
                    document.querySelector(`.image-option[data-index="${index}"]`).classList.add('selected');
                }
                
                checkSelectionComplete();
            }
        }

        // æ£€æŸ¥é€‰æ‹©æ˜¯å¦å®Œæˆ
        function checkSelectionComplete() {
            const level = gameData[currentLevel];
            
            if (level.type === "special") {
                confirmBtn.style.display = selectedTexts.length === 1 ? 'block' : 'none';
            } else {
                confirmBtn.style.display = (selectedTexts.length === 2 && selectedImages.length === 2) ? 'block' : 'none';
            }
        }

        // æ£€æŸ¥ç‰¹æ®Šå…³å¡ç­”æ¡ˆ
        function checkSpecialAnswer() {
            const level = gameData[currentLevel];
            const selectedTextIndex = selectedTexts[0];
            isResultShown = true;
            
            document.querySelectorAll('.text-option, .image-option').forEach(option => {
                option.style.pointerEvents = 'none';
            });
            
            if (selectedTextIndex === level.correctAnswer) {
                successMessage.textContent = level.successMessage;
                successMessage.style.display = 'block';
                
                confirmBtn.textContent = "ä¸‹ä¸€å…³";
                confirmBtn.onclick = nextLevel;
            } else {
                errorMessage.textContent = level.errorMessages[selectedTextIndex] || "å¾ˆé—æ†¾ï¼Œé€‰æ‹©é”™è¯¯ï¼";
                errorMessage.style.display = 'block';
                
                confirmBtn.textContent = "ä»å¤´å¼€å§‹";
                confirmBtn.classList.add('error');
                confirmBtn.onclick = function() {
                    currentLevel = 0;
                    level4Failed = false;
                    loadLevel(currentLevel);
                };
            }
        }

        // æ£€æŸ¥æ­£å¸¸å…³å¡ç­”æ¡ˆ
        function checkNormalAnswer() {
            const level = gameData[currentLevel];
            isResultShown = true;
            
            document.querySelectorAll('.text-option, .image-option').forEach(option => {
                option.style.pointerEvents = 'none';
            });
            
            let correct = true;
            let errorIndex = -1;
            
            for (let i = 0; i < selectedImages.length; i++) {
                const imageIndex = selectedImages[i];
                const textIndex = selectedTexts[i];
                
                if (level.correctPairs[imageIndex] !== textIndex) {
                    correct = false;
                    errorIndex = i;
                    break;
                }
            }
            
            if (correct) {
                // å¤„ç†ç¬¬4å…³çš„ç‰¹æ®Šé€»è¾‘
                if (currentLevel === 3) { // ç¬¬4å…³
                    level4Failed = false; // ç¬¬4å…³æ­£ç¡®ï¼Œé‡ç½®æ ‡è®°
                }
                
                // å¤„ç†ç¬¬5å…³çš„ç‰¹æ®Šå¤±è´¥é€»è¾‘
                if (currentLevel === 4 && level4Failed) { // ç¬¬5å…³ä¸”ç¬¬4å…³å¤±è´¥
                    specialMessage.textContent = level.specialFailMessage;
                    specialMessage.style.display = 'block';
                    
                    confirmBtn.textContent = "é‡æ–°å¼€å§‹";
                    confirmBtn.classList.add('error');
                    confirmBtn.onclick = function() {
                        currentLevel = 0;
                        level4Failed = false;
                        loadLevel(currentLevel);
                    };
                    return;
                }
                
                // æ­£å¸¸æ­£ç¡®æƒ…å†µ
                successMessage.textContent = level.successMessage;
                successMessage.style.display = 'block';
                
                // åªæœ‰ç¬¬3å…³æ­£ç¡®åå˜åŒ–å›¾ç‰‡
                if (level.changeImages && level.successImages) {
                    document.querySelectorAll('.image-option').forEach((option, index) => {
                        option.style.backgroundImage = `url(${level.successImages[index]})`;
                    });
                }
                
                if (currentLevel === 4) {
                    confirmBtn.textContent = "é‡æ–°å¼€å§‹";
                    confirmBtn.onclick = function() {
                        currentLevel = 0;
                        level4Failed = false;
                        loadLevel(currentLevel);
                    };
                } else {
                    confirmBtn.textContent = "ä¸‹ä¸€å…³";
                    confirmBtn.onclick = nextLevel;
                }
            } else {
                // å¤„ç†ç¬¬4å…³çš„ç‰¹æ®Šé€»è¾‘ï¼ˆä¸ä¼šè¾“æ‰æ¸¸æˆï¼‰
                if (currentLevel === 3) { // ç¬¬4å…³
                    level4Failed = true; // è®°å½•ç¬¬4å…³å¤±è´¥
                    successMessage.textContent = "çœ‹æ¥ä½ çš„å®¡ç¾æ¯”è¾ƒç‰¹åˆ«ã€‚ä¸¤äººçš„é­…åŠ›å‡å°‘35%";
                    successMessage.style.display = 'block';
                    
                    confirmBtn.textContent = "ä¸‹ä¸€å…³";
                    confirmBtn.onclick = nextLevel;
                    return;
                }
                
                // æ­£å¸¸é”™è¯¯æƒ…å†µ
                errorMessage.textContent = level.errorMessages[errorIndex] || "å¾ˆé—æ†¾ï¼ŒåŒ¹é…é”™è¯¯ï¼";
                errorMessage.style.display = 'block';
                
                confirmBtn.textContent = "ä»å¤´å¼€å§‹";
                confirmBtn.classList.add('error');
                confirmBtn.onclick = function() {
                    currentLevel = 0;
                    level4Failed = false;
                    loadLevel(currentLevel);
                };
            }
        }

        // ä¸‹ä¸€å…³
        function nextLevel() {
            currentLevel++;
            
            if (currentLevel < gameData.length) {
                loadLevel(currentLevel);
            } else {
                levelTitle.textContent = "æ­å–œä½ ï¼é€šå…³äº†ï¼";
                textOptionsContainer.innerHTML = '<div class="text-option">ğŸ‰ ä½ æˆåŠŸå…»æˆäº†ï¼š</div>';
                imageOptionsContainer.innerHTML = '<div class="image-option">ğŸŠ çš‡åå’Œæ­¦æ—è‡³å°Šï¼</div>';
                confirmBtn.textContent = "é‡æ–°å¼€å§‹";
                confirmBtn.onclick = function() {
                    currentLevel = 0;
                    level4Failed = false;
                    loadLevel(currentLevel);
                };
            }
        }

        // å¤´åƒåŠ è½½å¤±è´¥æ—¶ä½¿ç”¨å¤‡ç”¨æ–¹æ¡ˆ
        document.querySelector('.avatar').addEventListener('error', function() {
            this.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
            this.innerHTML = '<div style="line-height: 120px; color: white; font-size: 48px;">ğŸ˜Š</div>';
        });
    </script>
</body>
</html>